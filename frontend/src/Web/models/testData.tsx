// test-data-generator.ts
import { 
  projects, 
  userManager, 
  User,  
  Page, 
  Field 
} from '../models/DataModels';

// ===== Donn√©es de test pour les utilisateurs =====
export function createTestUsers() {
  console.log('üîß Cr√©ation des utilisateurs de test...');

  // Admin principal
  const admin = userManager.login('admin@formbuilder.com', 'Alexandre Dubois');
  if (admin) {
    admin.role = 'admin';
    admin.avatar = 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face';
    admin.preferences = {
      theme: 'dark',
      language: 'fr',
      notifications: true,
      defaultFormTheme: 'corporate'
    };
    userManager.updateProfile({
      name: 'Alexandre Dubois (Admin)',
      avatar: admin.avatar
    });
    userManager.updatePreferences(admin.preferences);
  }

  // √âditeur
  const editor = new User(
    'user-editor-001',
    'Sophie Martin',
    'sophie.martin@formbuilder.com',
    'editor'
  );
  editor.avatar = 'https://images.unsplash.com/photo-1494790108755-2616b52bf04b?w=150&h=150&fit=crop&crop=face';
  editor.preferences = {
    theme: 'light',
    language: 'fr',
    notifications: true,
    defaultFormTheme: 'business'
  };

  // Viewer
  const viewer = new User(
    'user-viewer-001',
    'Thomas Leroy',
    'thomas.leroy@formbuilder.com',
    'viewer'
  );
  viewer.avatar = 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face';
  viewer.preferences = {
    theme: 'auto',
    language: 'fr',
    notifications: false,
    defaultFormTheme: 'default'
  };

  // Designer
  const designer = new User(
    'user-designer-001',
    'Emma Rousseau',
    'emma.rousseau@formbuilder.com',
    'editor'
  );
  designer.avatar = 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face';
  designer.preferences = {
    theme: 'light',
    language: 'en',
    notifications: true,
    defaultFormTheme: 'luxury'
  };

  console.log('‚úÖ Utilisateurs cr√©√©s:', { admin: admin?.name, editor: editor.name, viewer: viewer.name, designer: designer.name });
}

// ===== Donn√©es de test pour les groupes et formulaires =====
export function createTestData() {
  console.log('üìù Cr√©ation des donn√©es de test...');

  // Groupe 1: Marketing & Communication
  const marketingGroup = projects.createGroup(
    'üì¢ Marketing & Communication',
    'Formulaires pour les campagnes marketing, enqu√™tes clients et √©v√©nements'
  );

  // Formulaire 1: Enqu√™te de satisfaction client
  const satisfactionForm = projects.createForm(
    marketingGroup.id,
    'business',
    'üåü Enqu√™te de Satisfaction Client 2024',
    'Aidez-nous √† am√©liorer nos services en r√©pondant √† cette enqu√™te rapide'
  );

  const page1 = new Page(1, 'Informations personnelles');
  page1.addField(new Field('field-name', 'text', 'Nom complet', true));
  page1.addField(new Field('field-email', 'email', 'Adresse email', true));
  page1.addField(new Field('field-company', 'text', 'Entreprise', false));
  page1.addField(new Field('field-role', 'select', 'Fonction', false));

  const page2 = new Page(2, '√âvaluation du service');
  page2.addField(new Field('field-rating', 'radio', 'Note globale de satisfaction', true));
  page2.addField(new Field('field-recommend', 'radio', 'Recommanderiez-vous nos services ?', true));
  page2.addField(new Field('field-feedback', 'textarea', 'Commentaires et suggestions', false));

  satisfactionForm.addPage(page1);
  satisfactionForm.addPage(page2);
  satisfactionForm.settings = {
    collectEmails: true,
    allowMultipleResponses: false,
    showProgressBar: true,
    pageNavigation: true
  };

  // Formulaire 2: Inscription √©v√©nement
  const eventForm = projects.createForm(
    marketingGroup.id,
    'corporate',
    'üé™ Inscription Conf√©rence Tech 2024',
    'Inscrivez-vous √† notre conf√©rence annuelle sur les nouvelles technologies'
  );

  const eventPage = new Page(1, 'Inscription');
  eventPage.addField(new Field('event-name', 'text', 'Nom et pr√©nom', true));
  eventPage.addField(new Field('event-email', 'email', 'Email professionnel', true));
  eventPage.addField(new Field('event-phone', 'tel', 'T√©l√©phone', false));
  eventPage.addField(new Field('event-company', 'text', 'Entreprise', true));
  eventPage.addField(new Field('event-position', 'text', 'Poste occup√©', false));
  eventPage.addField(new Field('event-experience', 'select', 'Ann√©es d\'exp√©rience', false));
  eventPage.addField(new Field('event-interests', 'checkbox', 'Sujets d\'int√©r√™t', false));
  eventPage.addField(new Field('event-dietary', 'textarea', 'R√©gimes alimentaires particuliers', false));

  eventForm.addPage(eventPage);

  // Groupe 2: Ressources Humaines
  const hrGroup = projects.createGroup(
    'üë• Ressources Humaines',
    'Formulaires RH: recrutement, √©valuations, formations et enqu√™tes internes'
  );

  // Formulaire 3: Candidature emploi
  const jobForm = projects.createForm(
    hrGroup.id,
    'luxury',
    'üíº Candidature - D√©veloppeur Full Stack',
    'Postulez pour rejoindre notre √©quipe de d√©veloppement'
  );

  const jobPage1 = new Page(1, 'Informations personnelles');
  jobPage1.addField(new Field('job-firstname', 'text', 'Pr√©nom', true));
  jobPage1.addField(new Field('job-lastname', 'text', 'Nom de famille', true));
  jobPage1.addField(new Field('job-email', 'email', 'Email', true));
  jobPage1.addField(new Field('job-phone', 'tel', 'T√©l√©phone', true));
  jobPage1.addField(new Field('job-address', 'textarea', 'Adresse compl√®te', false));
  jobPage1.addField(new Field('job-linkedin', 'url', 'Profil LinkedIn', false));
  jobPage1.addField(new Field('job-portfolio', 'url', 'Portfolio / GitHub', false));

  const jobPage2 = new Page(2, 'Exp√©rience professionnelle');
  jobPage2.addField(new Field('job-experience', 'select', 'Ann√©es d\'exp√©rience', true));
  jobPage2.addField(new Field('job-current-role', 'text', 'Poste actuel', false));
  jobPage2.addField(new Field('job-skills', 'checkbox', 'Comp√©tences techniques', true));
  jobPage2.addField(new Field('job-languages', 'checkbox', 'Langages de programmation', true));
  jobPage2.addField(new Field('job-frameworks', 'checkbox', 'Frameworks ma√Ætris√©s', false));

  const jobPage3 = new Page(3, 'Motivation');
  jobPage3.addField(new Field('job-motivation', 'textarea', 'Lettre de motivation', true));
  jobPage3.addField(new Field('job-salary', 'number', 'Pr√©tentions salariales (‚Ç¨)', false));
  jobPage3.addField(new Field('job-start-date', 'date', 'Date de disponibilit√©', true));
  jobPage3.addField(new Field('job-remote', 'radio', 'T√©l√©travail souhait√©', true));

  jobForm.addPage(jobPage1);
  jobForm.addPage(jobPage2);
  jobForm.addPage(jobPage3);
  jobForm.settings = {
    collectEmails: true,
    allowMultipleResponses: false,
    showProgressBar: true,
    pageNavigation: true
  };

  // Formulaire 4: √âvaluation annuelle
  const evaluationForm = projects.createForm(
    hrGroup.id,
    'default',
    'üìä √âvaluation Annuelle des Performances',
    'Auto-√©valuation et objectifs pour l\'ann√©e √† venir'
  );

  const evalPage1 = new Page(1, 'Bilan de l\'ann√©e');
  evalPage1.addField(new Field('eval-achievements', 'textarea', 'Principales r√©alisations', true));
  evalPage1.addField(new Field('eval-challenges', 'textarea', 'Difficult√©s rencontr√©es', false));
  evalPage1.addField(new Field('eval-skills-rating', 'radio', 'Auto-√©valuation des comp√©tences', true));

  const evalPage2 = new Page(2, 'Objectifs futurs');
  evalPage2.addField(new Field('eval-goals', 'textarea', 'Objectifs pour l\'ann√©e prochaine', true));
  evalPage2.addField(new Field('eval-training', 'checkbox', 'Formations souhait√©es', false));
  evalPage2.addField(new Field('eval-career', 'textarea', '√âvolution de carri√®re envisag√©e', false));

  evaluationForm.addPage(evalPage1);
  evaluationForm.addPage(evalPage2);

  // Groupe 3: √âducation & Formation
  const educationGroup = projects.createGroup(
    'üéì √âducation & Formation',
    'Formulaires √©ducatifs: inscriptions, √©valuations, feedback de formation'
  );

  // Formulaire 5: Inscription formation
  const trainingForm = projects.createForm(
    educationGroup.id,
    'retro',
    'üöÄ Formation React & TypeScript',
    'Inscrivez-vous √† notre formation intensive de 5 jours'
  );

  const trainingPage = new Page(1, 'Inscription formation');
  trainingPage.addField(new Field('training-name', 'text', 'Nom complet', true));
  trainingPage.addField(new Field('training-email', 'email', 'Email', true));
  trainingPage.addField(new Field('training-level', 'radio', 'Niveau actuel en d√©veloppement', true));
  trainingPage.addField(new Field('training-experience', 'checkbox', 'Technologies d√©j√† utilis√©es', false));
  trainingPage.addField(new Field('training-expectations', 'textarea', 'Attentes de la formation', false));
  trainingPage.addField(new Field('training-schedule', 'radio', 'Cr√©neaux pr√©f√©r√©s', true));

  trainingForm.addPage(trainingPage);

  // Formulaire 6: Quiz technique
  const quizForm = projects.createForm(
    educationGroup.id,
    'cyberpunk',
    'üß† Quiz JavaScript Avanc√©',
    'Testez vos connaissances en JavaScript moderne'
  );

  const quizPage1 = new Page(1, 'Questions fondamentales');
  quizPage1.addField(new Field('quiz-q1', 'radio', 'Quelle est la diff√©rence entre let et var ?', true));
  quizPage1.addField(new Field('quiz-q2', 'radio', 'Comment fonctionne le hoisting ?', true));
  quizPage1.addField(new Field('quiz-q3', 'checkbox', 'Quelles sont les m√©thodes d\'array ES6+ ?', true));

  const quizPage2 = new Page(2, 'JavaScript moderne');
  quizPage2.addField(new Field('quiz-q4', 'radio', 'Qu\'est-ce qu\'une Promise ?', true));
  quizPage2.addField(new Field('quiz-q5', 'radio', 'Comment utiliser async/await ?', true));
  quizPage2.addField(new Field('quiz-q6', 'textarea', 'Expliquez les closures', true));

  quizForm.addPage(quizPage1);
  quizForm.addPage(quizPage2);
  quizForm.settings = {
    collectEmails: true,
    allowMultipleResponses: true,
    showProgressBar: true,
    pageNavigation: false
  };

  // Groupe 4: Sant√© & Bien-√™tre
  const healthGroup = projects.createGroup(
    'üè• Sant√© & Bien-√™tre',
    'Formulaires m√©dicaux, enqu√™tes de sant√© et questionnaires bien-√™tre'
  );

  // Formulaire 7: Questionnaire sant√©
  const healthForm = projects.createForm(
    healthGroup.id,
    'emerald',
    'ü©∫ Questionnaire de Sant√© Pr√©ventive',
    '√âvaluation de votre √©tat de sant√© g√©n√©ral'
  );

  const healthPage = new Page(1, 'Informations de sant√©');
  healthPage.addField(new Field('health-age', 'number', '√Çge', true));
  healthPage.addField(new Field('health-gender', 'radio', 'Genre', false));
  healthPage.addField(new Field('health-conditions', 'checkbox', 'Conditions m√©dicales actuelles', false));
  healthPage.addField(new Field('health-medications', 'textarea', 'M√©dicaments pris r√©guli√®rement', false));
  healthPage.addField(new Field('health-allergies', 'textarea', 'Allergies connues', false));
  healthPage.addField(new Field('health-exercise', 'radio', 'Fr√©quence d\'exercice', false));
  healthPage.addField(new Field('health-diet', 'radio', 'Type d\'alimentation', false));
  healthPage.addField(new Field('health-sleep', 'radio', 'Qualit√© du sommeil', false));

  healthForm.addPage(healthPage);

  console.log('‚úÖ Donn√©es de test cr√©√©es:');
  console.log(`üìÅ Groupes: ${projects.getAllGroups().length}`);
  console.log(`üìã Formulaires: ${projects.getAllForms().length}`);
  console.log('üìä D√©tail des formulaires:');
  projects.getAllForms().forEach(form => {
    const totalFields = form.pages.reduce((sum, page) => sum + page.fields.length, 0);
    console.log(`  ‚Ä¢ ${form.title}: ${form.pages.length} page(s), ${totalFields} champ(s)`);
  });
}

// ===== Fonction pour g√©n√©rer des r√©ponses de test =====
export function createTestResponses() {
  console.log('üìù G√©n√©ration de r√©ponses de test...');
  
  // Simuler des r√©ponses pour quelques formulaires
  const responses = [
    {
      formId: 1,
      responses: {
        'field-name': 'Jean Dupont',
        'field-email': 'jean.dupont@email.com',
        'field-company': 'TechCorp SARL',
        'field-rating': 'Tr√®s satisfait',
        'field-recommend': 'Oui, certainement',
        'field-feedback': 'Excellent service, √©quipe tr√®s professionnelle.'
      },
      submittedAt: '2024-01-15T10:30:00Z',
      userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
    },
    {
      formId: 2,
      responses: {
        'event-name': 'Marie Dubois',
        'event-email': 'marie.dubois@startup.io',
        'event-company': 'InnovateLab',
        'event-position': 'CTO',
        'event-experience': '5-10 ans',
        'event-interests': ['IA & Machine Learning', 'Cloud Computing', 'Cybers√©curit√©']
      },
      submittedAt: '2024-01-16T14:22:00Z',
      userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36'
    }
  ];

  // Sauvegarder les r√©ponses (vous pourriez √©tendre votre syst√®me pour g√©rer cela)
  localStorage.setItem('form_builder_responses', JSON.stringify(responses));
  console.log(`‚úÖ ${responses.length} r√©ponses de test g√©n√©r√©es`);
}

// ===== Fonction principale pour tout initialiser =====
export function initializeTestData() {
  console.log('üöÄ Initialisation compl√®te des donn√©es de test...');
  
  try {
    createTestUsers();
    createTestData();
    createTestResponses();
    
    console.log('üéâ Toutes les donn√©es de test ont √©t√© cr√©√©es avec succ√®s !');
    console.log('üìã R√©sum√©:');
    console.log(`  üë• Utilisateurs: 4`);
    console.log(`  üìÅ Groupes: ${projects.getAllGroups().length}`);
    console.log(`  üìã Formulaires: ${projects.getAllForms().length}`);
    console.log(`  üìä R√©ponses: 2`);
    
    return true;
  } catch (error) {
    console.error('‚ùå Erreur lors de la cr√©ation des donn√©es de test:', error);
    return false;
  }
}

// ===== Fonction pour nettoyer toutes les donn√©es =====
export function clearAllTestData() {
  console.log('üßπ Suppression de toutes les donn√©es de test...');
  
  
  userManager.logout();
  localStorage.removeItem('form_builder_responses');
  localStorage.removeItem('form_builder_users');
  localStorage.removeItem('form_builder_current_user');
  
  console.log('‚úÖ Toutes les donn√©es ont √©t√© supprim√©es');
}

// ===== Script d'ex√©cution =====
if (typeof window !== 'undefined') {
  // Ajouter les fonctions au window pour les utiliser dans la console
  (window as any).initTestData = initializeTestData;
  (window as any).clearTestData = clearAllTestData;
  (window as any).projects = projects;
  (window as any).userManager = userManager;
  
  console.log('üîß Fonctions de test disponibles:');
  console.log('  ‚Ä¢ initTestData() - Cr√©er toutes les donn√©es de test');
  console.log('  ‚Ä¢ clearTestData() - Supprimer toutes les donn√©es');
  console.log('  ‚Ä¢ projects - Acc√®s √† l\'instance projects');
  console.log('  ‚Ä¢ userManager - Acc√®s √† l\'instance userManager');
}

export default {
  initializeTestData,
  clearAllTestData,
  createTestUsers,
  createTestData,
  createTestResponses
};
 